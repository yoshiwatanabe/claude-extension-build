<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matrix Diagram</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f8f9fa; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .header { padding: 24px; background: linear-gradient(135deg, #2E86AB 0%, #A23B72 100%); color: white; }
        .header h1 { font-size: 24px; margin-bottom: 8px; }
        .header p { font-size: 14px; opacity: 0.9; }
        .matrix-container { padding: 20px; overflow: auto; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; text-align: left; border: 1px solid #eee; }
        th { background: #2E86AB; color: white; font-weight: 600; position: sticky; top: 0; z-index: 1; }
        th:first-child { position: sticky; left: 0; z-index: 2; }
        td:first-child { background: #f8f9fa; font-weight: 500; position: sticky; left: 0; }
        tbody tr:hover { background: #f0f4f8; }
        .score { display: inline-block; width: 24px; height: 24px; border-radius: 4px; text-align: center; line-height: 24px; font-weight: bold; font-size: 12px; }
        .score-5 { background: #C94C4C; color: white; }
        .score-4 { background: #FF8C42; color: white; }
        .score-3 { background: #F4B860; color: #333; }
        .score-2 { background: #44A08D; color: white; }
        .score-1 { background: #4ECDC4; color: white; }
        .score-0, .no-score { background: #ccc; color: white; }
        .cell-content { font-size: 13px; color: #222; }
        .cell-score { font-size: 11px; color: #666; margin-top: 4px; }
        .tooltip { position: absolute; background: white; border: 1px solid #ddd; border-radius: 6px; padding: 12px; font-size: 12px; z-index: 10; box-shadow: 0 2px 8px rgba(0,0,0,0.15); max-width: 300px; display: none; }
        .tooltip.active { display: block; }
        .tooltip-title { font-weight: 600; margin-bottom: 4px; }
        .tooltip-desc { color: #666; font-size: 11px; line-height: 1.4; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="title">Matrix</h1>
            <p id="description"></p>
        </div>
        <div class="matrix-container">
            <table id="matrix"></table>
        </div>
    </div>

    <div class="tooltip" id="tooltip">
        <div class="tooltip-title" id="tooltip-title"></div>
        <div class="tooltip-desc" id="tooltip-desc"></div>
    </div>

    <script>
        const diagramData = __DIAGRAM_DATA__;

        document.getElementById('title').textContent = diagramData.title || 'Matrix';
        document.getElementById('description').textContent = diagramData.description || '';

        const table = document.getElementById('matrix');
        const tooltip = document.getElementById('tooltip');

        // Create header
        const thead = document.createElement('thead');
        const headerRow = document.createElement('tr');
        const cornerHead = document.createElement('th');
        cornerHead.textContent = '';
        headerRow.appendChild(cornerHead);

        diagramData.columns.forEach(col => {
            const th = document.createElement('th');
            th.textContent = col.label;
            th.title = col.description || '';
            headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
        table.appendChild(thead);

        // Create body
        const tbody = document.createElement('tbody');
        diagramData.rows.forEach(row => {
            const tr = document.createElement('tr');

            const rowHeader = document.createElement('td');
            rowHeader.textContent = row.label;
            rowHeader.title = row.description || '';
            rowHeader.style.fontWeight = 'bold';
            tr.appendChild(rowHeader);

            diagramData.columns.forEach(col => {
                const cell = document.createElement('td');
                const cellData = diagramData.cells.find(c => c.row === row.id && c.col === col.id);

                if (cellData) {
                    const score = cellData.score || 0;
                    const scoreClass = `score score-${Math.round(score)}`;

                    const content = document.createElement('div');
                    content.className = 'cell-content';
                    content.textContent = cellData.value || '-';

                    if (score > 0) {
                        const scoreEl = document.createElement('div');
                        scoreEl.className = scoreClass;
                        scoreEl.textContent = score;
                        content.appendChild(scoreEl);
                    }

                    cell.appendChild(content);

                    cell.addEventListener('mouseenter', (e) => {
                        tooltip.classList.add('active');
                        document.getElementById('tooltip-title').textContent = `${row.label} - ${col.label}`;
                        document.getElementById('tooltip-desc').textContent = cellData.description || '';
                        tooltip.style.left = (e.pageX + 10) + 'px';
                        tooltip.style.top = (e.pageY + 10) + 'px';
                    });

                    cell.addEventListener('mouseleave', () => {
                        tooltip.classList.remove('active');
                    });
                } else {
                    cell.textContent = '-';
                }

                tr.appendChild(cell);
            });

            tbody.appendChild(tr);
        });
        table.appendChild(tbody);
    </script>
</body>
</html>
